import numpy as np
import pandas as pd
import streamlit as st
import pickle

from utils.data_utils import get_features___

st.write("Benign or Malware - URL Detection", )

model_name = st.selectbox('Select Model', ['KNN', 'LogisticRegression', 'RandomForest', 'MLP', 'XGBoost'])

if model_name == 'KNN':
    model_path = '27-08-2024_10-35-51_KnnClassifier.pickle'
elif model_name == 'LogisticRegression':
    model_path = '27-08-2024_10-36-24_LogisticRegression.pickle'
elif model_name == 'RandomForest':
    model_path = '27-08-2024_10-37-42_RandomForestClassifier.pickle'
elif model_name == 'MLP':
    model_path = '27-08-2024_10-37-06_MLPRegressor.pickle'
elif model_name == 'XGBoost':
    model_path = '27-08-2024_10-47-48_XGBoost.pickle'

with open(model_path, 'rb') as fp:
    model = pickle.load(fp)




url = st.text_input("Insert your URL here")
if url:
    f = get_features___(pd.DataFrame([url], columns=['url']))
    x = np.array(list(f.values())).reshape(1, -1)

    p = model.predict(x)
    st.write("Malware" if p[0] == 1 else "Benign")
