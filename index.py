import numpy as np
import pandas as pd
import streamlit as st
import pickle

from utils.data_utils import get_features___

st.write("Benign or Malware - URL Detection", )

url = st.text_input("Insert your URL here")

model = None
model_path = '14-08-2024_12-18-17_KnnClassifier.pickle'
with open(model_path, 'rb') as fp:
    model = pickle.load(fp)

if url:
    f = get_features___(pd.DataFrame([url], columns=['url']))
    x = np.array(list(f.values())).reshape(1, -1)

    p = model.predict(x)
    st.write("Malware" if p[0] == 1 else "Benign")
