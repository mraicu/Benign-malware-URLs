import pandas as pd

from utils.data_utils import get_pairs_features, get_lexical_features

def create_pairs_features():
    train_data = pd.read_csv('data/urls/train.csv')
    test_data = pd.read_csv('data/urls/test.csv')

    train_pairs_data = get_pairs_features(train_data[:int(0.01*len(train_data))])
    print('Train pairs features created. Writing to csv ...')
    train_pairs_data.to_csv('data/pairs_features/train.csv', index=False)
    print('Train pairs features written to csv.')

    test_pairs_data = get_pairs_features(test_data[:int(0.01*len(test_data))])
    print('Test pairs features created. Writing to csv ...')
    test_pairs_data.to_csv('data/pairs_features/test.csv', index=False)
    print('Test pairs features written to csv.')


create_pairs_features()


def create_lexical_features():
    train_data = pd.read_csv('data/urls/train.csv')
    test_data = pd.read_csv('data/urls/test.csv')

    train_lexical_data = get_lexical_features(train_data)
    test_lexical_data = get_lexical_features(test_data)

    train_lexical_data.to_csv('data/lexical_features/train.csv', index=False)
    test_lexical_data.to_csv('data/lexical_features/test.csv', index=False)